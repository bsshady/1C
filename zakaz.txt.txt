Процедура СоздатьПКОИзExcel()
    Перем НомерСтолбцаДата, НомерСтолбцаСумма, ПерваяСтрока, ПоследняяСтрока;
    Перем Склад, ФайлExcel, Лист, Строка, Данные, ОбщаяСумма, КоличествоПКО;

    // Получаем данные с формы
    НомерСтолбцаДата = ?; // Номер столбца с датой в Excel
    НомерСтолбцаСумма = ?; // Номер столбца с суммой в Excel
    ПерваяСтрока = ?; // Номер первой строки с данными в Excel
    ПоследняяСтрока = ?; // Номер последней строки с данными в Excel
    Склад = ?; // Значение "Склад" с формы

    // Открываем диалог выбора файла Excel
    ФайлExcel = ФайлВыбрать("Выберите файл Excel", "Excel файлы|*.xls;*.xlsx");

    // Проверяем наличие файла
    Если Не ЗначениеЗаполнено(ФайлExcel) Тогда
        Сообщить("Файл Excel не выбран");
        Возврат;
    КонецЕсли;

    // Открываем Excel и загружаем файл
    Попытка
        Excel = Новый COMОбъект("Excel.Application");
        Excel.Visible = Ложь; // Не отображать Excel
        Лист = Excel.Workbooks.Open(ФайлExcel).Worksheets(1);
        
        // Инициализируем переменные
        ОбщаяСумма = 0;
        КоличествоПКО = 0;
        
        // Обходим строки в Excel
        Для Строка = ПерваяСтрока До ПоследняяСтрока Цикл
            // Получаем данные из Excel
            Данные.Дата = Лист.Cells(Строка, НомерСтолбцаДата).Value;
            Данные.Сумма = Лист.Cells(Строка, НомерСтолбцаСумма).Value;
            
            // Проверяем условие
            Если Не ЗначениеЗаполнено(Данные.Дата) ИЛИ Данные.Сумма = 0 Тогда
                Продолжить; // Пропускаем строку
            КонецЕсли;
            
            // Создаем ПКО
            СоздатьПКО(Данные, Склад);
            
            // Увеличиваем общую сумму и количество ПКО
            ОбщаяСумма = ОбщаяСумма + Данные.Сумма;
            КоличествоПКО = КоличествоПКО + 1;
        КонецЦикла;
        
        // Выводим результат
        Сообщить("Создано " + КоличествоПКО + " ПКО с общей суммой " + ОбщаяСумма);
    Исключение
        Сообщить("Ошибка при работе с Excel: " + Ошибка());
    КонецПопытки;
    
    // Закрываем Excel
    Если ЗначениеЗаполнено(Excel) Тогда
        Excel.Quit;
        Excel = Неопределено;
    КонецЕсли;
КонецПроцедуры

Процедура СоздатьПКО(Данные, Склад)
    // Здесь код создания ПКО на основании данных из Excel
    // И заполнение его данными (дата, сумма, ставка НДС, склад и другие параметры)
    // Далее проведение ПКО
    
    // Пример создания и заполнения ПКО:
    ПКО = Документы.ПоступлениеКассовыхОрдеров.СоздатьДокумент();
    ПКО.ВидОперации = Справочники.ВидыОпераций.РозничнаяВыручка;
    ПКО.ДатаДокумента = Данные.Дата;
    ПКО.СуммаДокумента = Данные.Сумма;
    ПКО.СтавкаНДС = Перечисления.СтавкиНДС.БезНДС;
    ПКО.Склад = Склад;
    
    // Здесь можно провести дополнительные операции
    // (например, добавить проводки, связанные с ПКО)
    
    // Записываем ПКО
    ПКО.Записать();
    
КонецПроцедуры
